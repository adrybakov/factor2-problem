\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc} % for correct << and >>
\usepackage{amssymb, amsmath, multicol, amsthm, mathtools}
\usepackage{csquotes}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{indentfirst}
\usepackage{esvect}
\usepackage{float} 
\usepackage[version=4]{mhchem}
\mathtoolsset{showonlyrefs=true}
\usepackage{hyperref}
\usepackage[rgb,table,xcdraw]{xcolor}
\hypersetup{				
	unicode=true,        
	colorlinks=true,       	
	linkcolor=black,        
	citecolor=black,        
	filecolor=magenta,      
	urlcolor=black         
}

\usepackage[left=2cm,right=2cm,
    top=2cm,bottom=2cm]{geometry}
\usepackage{fancyhdr}


\graphicspath{{images}}

\newcommand{\angstrom}{\text{\normalfont\AA}}
\newcommand{\iu}{\mathrm{i}\mkern1mu}
\newcommand*{\hatH}{\hat{\mathcal{H}}}


\begin{document}

    \section{Definition of the Hamiltonian}

        There is a number of details in the definition of the Heisenberg Hamiltonians, which may cause an incompatibility of the direct results. 
        In this paper the main definition is as follows:

        \begin{equation}
            \hat{H} = -J \sum_{ij} \hat{\mathbf{S}}_i^T \hat{\mathbf{S}}_j
            \label{eq:hh-main}
        \end{equation}
        where $J$ is an isotropic exchange parameter. The double counting is present in the Hamiltonian, i.e. both terms $i\rightarrow j$ and $j \rightarrow i$ are present in the sum. 
        $\hat{\mathbf{S}}_i$ is a $3\times1$ column vector of the spin operators $(\hat{\mathbf{S}}_i^x, \hat{\mathbf{S}}_i^y, \hat{\mathbf{S}}_i^z)$. 
        Index $i$ run over all $N$ sites in the system and index $j$ runs over neighbors for the site $i$. 

        Bold mathematical symbols in this work represent vectors or matrices and usual symbols - scalars. For instance, $J$ is a scalar exchange parameter, while $\mathbf{J}$ is a matrix of exchange, 
        for the isotropic case it is defined as

        \begin{equation}
            \mathbf{J} =
            \begin{pmatrix}
                J & 0 & 0 \\
                0 & J & 0 \\
                0 & 0 & J
            \end{pmatrix}
        \end{equation}

        Several comparisons of the exchange Hamiltonians and consecutive spin wave Hamiltonians will be done in this paper and for each one the details of the convergence will be discussed. 
        When possible the results will be present in both ways: the original source and in the definition of this paper.

    \section{Ferromagnetic cubic system}

        In this section I will define the parameters and they values for the case study system - 
        cubic lattice of ferromagnetic spins oriented along the direction of $z$ axis.

        Lattice (see~Fig.~\ref{fig:lattice}) in cartesian coordinate system is defined by the lattice parameters and angles:
        \begin{equation}
            \begin{matrix}
                \mathbf{a} = (l, 0, 0) & \mathbf{b} = (0, l, 0) & \mathbf{c} = (0, 0, l) \\
                \alpha = 90^{\circ} & \beta = 90^{\circ} & \gamma = 90^{\circ} \\
            \end{matrix}
        \end{equation}
        In each unit cell there is one spin $S$ at the position $(0, 0, 0)$ (in relative coordinates).

        Spin in the $(0, 0, 0)$ unit cell will have 6 neighbors as shown in Fig.~\ref{fig:lattice-neighbors}.

        \begin{figure}[H]
            \centering
            \begin{subfigure}[b]{0.49\textwidth}
                \centering
                \includegraphics[height=6cm]{lattice.pdf}
                \caption{}
            \label{fig:lattice}
            \end{subfigure}
            \hfill
            \begin{subfigure}[b]{0.49\textwidth}
                \centering
                \includegraphics[height=6cm]{lattice-neighbors.pdf}
            \caption{}
            \label{fig:lattice-neighbors}
            \end{subfigure}
            \hfill
            \caption{(a) Lattice and (b) 6 neighbors for the spin in $(0, 0, 0)$ unit cell.}
            \label{fig:lattice-both}
        \end{figure}


        The reciprocal lattice will have the form of:
        \begin{equation}
            \begin{matrix}
                \mathbf{b_1} = (\dfrac{2\pi}{l}, 0, 0) & \mathbf{b_2} = (0,\dfrac{2\pi}{l}, 0) & \mathbf{b_3} = (0, 0, \dfrac{2\pi}{l}) \\
                k_{\alpha} = 90^{\circ} & k_{\beta} = 90^{\circ} & k_{\gamma} = 90^{\circ} \\
            \end{matrix}
        \end{equation}

        Magnon dispersion plots will use the following path: Y-$\Gamma$-X-M-$\Gamma$-R-X$\vert$M-R (see~Fig.~\ref{fig:path}).

        \begin{figure}[H]
            \centering
            \begin{subfigure}[b]{0.8\textwidth}
                \centering
                \includegraphics[height=10cm]{path.pdf}
            \end{subfigure}
            \hfill
            \caption{Path in reciprocal space for the magnon dispersion plot: Y-$\Gamma$-X-M-$\Gamma$-R-X$\vert$M-R.}
            \label{fig:path}
        \end{figure}


        For the final results and for the Figs.~\ref{fig:lattice-both}~and~\ref{fig:path} the following numerical values are used:
        \begin{equation}
            \begin{matrix}
                J = 1 \text{ meV}, & S = 1, & l = 1, & n = 6
            \end{matrix}
        \end{equation}

    \section{Main magnon dispersion}

        In Appendix I magnon dispersion is derived from the Hamiltonian~in~\eqref{eq:hh-main}.
        The final result is present in equation~\ref{eq:main-dispersion}. 

        \begin{equation}
            \boxed{
            \hbar\omega(\mathbf{k}) = 2JSn\left(1 - 
            \dfrac{1}{3}\left(\cos(k_x l) + \cos(k_y l) + \cos(k_z l)\right)\right)}
            \label{eq:main-dispersion}
        \end{equation}

        In Fig.~\ref{fig:main-dispersion} is plotted for the path Y-$\Gamma$-X-M-$\Gamma$-R-X$\vert$M-R. 
        The picture is produced with the script <<codes/dispersion.py>> using 
        <<main\_dispersion>> function.


        \begin{figure}[H]
            \centering
            \begin{subfigure}[b]{0.8\textwidth}
                \centering
                \includegraphics[height=7cm]{main_dispersion.pdf}
            \end{subfigure}
            \hfill
            \caption{Magnon dispersion plotted with equation~\eqref{eq:main-dispersion}.}
            \label{fig:main-dispersion}
        \end{figure}

        \section{Literature check}
        In this section I will compare the result in equation~\eqref{eq:main-dispersion} with the textbook results. 
        For each source Hamiltonian definitions are compared with the equation~\eqref{eq:hh-main} and make conversion if necessary. 
        Detail consideration of each source is provided in Appendix~II. In Table~\ref{tab:literature-review} the summary of textbooks review is provided.

        \begin{table}[H]
            \centering
            \caption{Comparasion of magnon dispersion formulas with textbooks (converted to the notation of this paper).}
            \label{tab:literature-review}
            \def\arraystretch{2.5}
            \begin{tabular}{|c|c|}
            \hline
            Source                             & Formula                                                                                                        \\ \hline
            This paper                         & $\hbar\omega(\mathbf{k}) = 2JSn\left(1 - \dfrac{1}{3}\left(\cos(k_xl) + \cos(k_yl) + \cos(k_zl)\right)\right)$ \\ \hline
            \cite{rezende2020fundamentals}     & $\hbar\omega(\mathbf{k}) = 2nJS\left(1 - \dfrac{1}{3}\left(\cos(k_xa) + \cos(k_ya) + \cos(k_za)\right)\right)$ \\ \hline
            \cite{blundell2003magnetism}       & $\hbar\omega(\mathbf{k}) = 2nJS\left(1 - \dfrac{1}{3}\left(\cos(k_xl) + \cos(k_yl) + \cos(k_zl)\right)\right)$ \\ \hline
            \cite{gurevich1996magnetization}   & $\hbar\omega(\mathbf{k}) = 2SJn\left(1 - \dfrac{1}{3}\left(\cos(k_xl) + \cos(k_yl) + \cos(k_zl)\right)\right)$ \\ \hline
            \cite{simon2013oxford}             & $\hbar\omega(\mathbf{k}) = 2JSn\left(1 - \dfrac{1}{3}\left(\cos(k_xl) + \cos(k_yl) + \cos(k_zl)\right)\right)$ \\ \hline
            \cite{coey2010magnetism}           &  \\ \hline
            \cite{jensen1991rare}              &  \\ \hline
            \end{tabular}
            \end{table}

    \include{Appendix_I.tex}

    \include{Appendix_II.tex}

    \newpage
    \bibliographystyle{plain} 
    \bibliography{refs.bib} 
    % \section*{References}
    % \printbibliography[title = {\vspace{-2em}}]



\end{document}
